---
title: "website"
execute: 
  echo: false
---

```{r}
#| message: false
#| label: setup

library(tidyverse)
library(dplyr)
library(readr)
library(ggplot2)
library(ggtext)
library(hrbrthemes)
library(knitr)
summary <- read_csv("summary.csv")
offensive <- read_csv("offensive.csv")
xg <- read_csv("xg.csv")
passing <- read_csv("passing.csv")
away <- read_csv("away.csv")
home <- read_csv("home.csv")
```


```{r}
# away |>
  # ggplot(aes(x = Rating, y = Player, color = Player)) + 
  # geom_point() 
```



```{r, fig.width=20, fig.height=10}
#| warning: false


summary <- summary %>%
  mutate(mins_age = Mins / Age) %>%
  arrange(desc(mins_age)) %>%
  mutate(Player_label = paste0('<span style="color:blue;">', Player, '</span> <span style="color:black;">(', Age, ')</span>'))


ggplot(summary, aes(y = mins_age, x = reorder(Player_label, mins_age))) +
  geom_segment(aes(y = 0, yend = mins_age), color = "orange", size = 0.9) +
  geom_point(color = "grey", size = 2.5) +
  theme_ipsum() +
  coord_flip() +
  theme(legend.position = "none") +
  xlab("") +
  ylab("") +
  ggtitle("") +
  theme(axis.text.y = element_markdown(size = 17, angle = 0, hjust = 1)) 

```



```{r, fig.width=20, fig.height=10}
theme_set(theme_bw())

xg$Player <- factor(xg$Player, levels = xg$Player[order(xg$xGDiff)])

ggplot(xg, aes(x = Player, y = xGDiff, label = xGDiff)) + 
  geom_segment(aes(y = 0, 
                   x = Player, 
                   yend = xGDiff, 
                   xend = Player), 
               color = "black") +
  geom_point(stat = 'identity', aes(fill = ifelse(xGDiff > 0, "Positive", "Negative")), size = 6.3, shape = 21) +
  geom_text(color = "black", size = 2) +
  scale_fill_manual(values = c("Positive" = "green", "Negative" = "red")) +
  labs(title = "", 
       subtitle = "",
       fill = "xGDiff") +
  coord_flip()
```


```{r}

xg$Player <- factor(xg$Player, levels = xg$Player[order(xg$xGDiff)])

ggplot(xg, aes(x = Player, y = xGDiff)) + 
  geom_bar(stat = 'identity', 
           aes(fill = ifelse(xGDiff > 0, "Positive", "Negative")), 
           width = .5) +
  scale_fill_manual(values = c("Positive" = "green", "Negative" = "red")) +
  labs(subtitle = "", 
       title = "",
       fill="xGDiff") + 
  coord_flip()

```



